import axios from 'axios';

export const client = axios.create({
  timeout: 20 * 1000,
  baseURL: process.env.EXPO_PUBLIC_API_URL,
});

client.interceptors.request.use((config) => {
  // const suffix = process.env.EXPO_PUBLIC_DYNAMIC_ENVIRONMENT_ID ?? '';
  // const token = localStorage.getItem(`dynamic_authentication_token_${suffix}`);

  const token =
    'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImI0OThjOTU4LTZhNmUtNDVjYS05M2YwLThjODJhMmNhNmFmZiJ9.eyJraWQiOiJiNDk4Yzk1OC02YTZlLTQ1Y2EtOTNmMC04YzgyYTJjYTZhZmYiLCJhdWQiOiJodHRwczovL3Jvem9haS1wb3MuZXhwby5hcHAiLCJpc3MiOiJhcHAuZHluYW1pY2F1dGguY29tL2Y5NDc0OGYyLTk5NzgtNDNhYS04YjllLWVkOTRkNzlmNjI2NCIsInN1YiI6IjBkNzMyNTIzLTYxYmYtNDA5NC04MWM1LWMyODExMTJlOTcyOSIsInNpZCI6IjU2YzhlMTAyLWQ5YTctNDE4Ni1iMWI3LTc5ZjdlMzJhMWJlZSIsInNlc3Npb25fcHVibGljX2tleSI6IjAzZGQ4ZTY1OTZlYTUzODAwNDU3Nzg1NTZmNDYyNGYzODFlNzdhMzQzMjcyYWJmMWVhY2IxMzBkMDA1YThmNmYyZCIsImVtYWlsIjoieWFoeWEuZmFraHJvamlAZ21haWwuY29tIiwiZW52aXJvbm1lbnRfaWQiOiJmOTQ3NDhmMi05OTc4LTQzYWEtOGI5ZS1lZDk0ZDc5ZjYyNjQiLCJsaXN0cyI6W10sIm1pc3NpbmdfZmllbGRzIjpbXSwidmVyaWZpZWRfY3JlZGVudGlhbHMiOlt7ImFkZHJlc3MiOiIweDY3RDM4MTJBNDY5NTUwRjlkYUU0Mzg1N2NlZDgwRWQ3Njg0OTYzZjAiLCJjaGFpbiI6ImVpcDE1NSIsImlkIjoiNDY4ZWRmZDUtNzY2YS00MWJiLTlkZDMtOGQyZDAyMWU2ZjBjIiwibmFtZV9zZXJ2aWNlIjp7fSwicHVibGljX2lkZW50aWZpZXIiOiIweDY3RDM4MTJBNDY5NTUwRjlkYUU0Mzg1N2NlZDgwRWQ3Njg0OTYzZjAiLCJ3YWxsZXRfbmFtZSI6InR1cm5rZXloZCIsIndhbGxldF9wcm92aWRlciI6ImVtYmVkZGVkV2FsbGV0Iiwid2FsbGV0X3Byb3BlcnRpZXMiOnsidHVybmtleVN1Yk9yZ2FuaXphdGlvbklkIjoiM2VkYjIxYTgtNDQ3Yi00ZmVlLWI3MjQtYTlhYTNhZWI3MDAwIiwidHVybmtleUhEV2FsbGV0SWQiOiIwOWZmZmU3Mi0wMDJjLTU4MWEtODU4Mi1jOTcxYzMxNTEzNzYiLCJpc0F1dGhlbnRpY2F0b3JBdHRhY2hlZCI6ZmFsc2UsInR1cm5rZXlVc2VySWQiOiJiYTIwNDdjYy1kNjczLTQ3YjgtOTZiOS0wNjI0YzM0YTBkMmIiLCJpc1Nlc3Npb25LZXlDb21wYXRpYmxlIjp0cnVlLCJ2ZXJzaW9uIjoiVjIifSwiZm9ybWF0IjoiYmxvY2tjaGFpbiIsImxhc3RTZWxlY3RlZEF0IjoiMjAyNS0wNi0xM1QxMDoyNTozMy4yMjRaIiwic2lnbkluRW5hYmxlZCI6ZmFsc2V9LHsiZW1haWwiOiJ5YWh5YS5mYWtocm9qaUBnbWFpbC5jb20iLCJpZCI6IjU1ODQyNDliLTRiNGItNDI3MC1hODIyLWFmYmZhODRmMTZkZCIsInB1YmxpY19pZGVudGlmaWVyIjoieWFoeWEuZmFraHJvamlAZ21haWwuY29tIiwiZm9ybWF0IjoiZW1haWwiLCJzaWduSW5FbmFibGVkIjp0cnVlfV0sImxhc3RfdmVyaWZpZWRfY3JlZGVudGlhbF9pZCI6IjU1ODQyNDliLTRiNGItNDI3MC1hODIyLWFmYmZhODRmMTZkZCIsImZpcnN0X3Zpc2l0IjoiMjAyNS0wNi0xMVQxNDoxODozNC42ODBaIiwibGFzdF92aXNpdCI6IjIwMjUtMDYtMTNUMTA6MjU6MzMuMTM4WiIsIm5ld191c2VyIjpmYWxzZSwibWV0YWRhdGEiOnt9LCJ2ZXJpZmllZENyZWRlbnRpYWxzSGFzaGVzIjp7ImJsb2NrY2hhaW4iOiIwZDYxMDBlMDJlMjMyMDNlMGZjMWVlYTNiMWUwZDkyYSIsImVtYWlsIjoiYmJmNTg2MjgxNGNjYzQyNGVmYTExMGQyNDUyZGNiZjMifSwiaWF0IjoxNzQ5ODEwMzMzLCJleHAiOjE3NDk4MTc1MzN9.RuDtcTzdAU7jWcElEBmtTSpQMAC00SmrWjHrYZhpnRUTJ6A59W270B1-i9-zNKTlhuoQME3_FEYeW2x74mqTzEuUeTD4OkOG4JKx5Zlps4pU_GxiG_eyDM2Gq3Og6m4e1ttLqYS-6oZqFuM3PAS2hY-Ip9Ml7wPGCa3-_owQZ-RBA2JopbJa_rwmdq5FbI0CDfpw9vZw6owcXuxYdCE6stNjSx6CsZtv0mDrzK-GV0TEM2_B43HV7ICsnaQOaf4RR1p_BbiiLhE-_lIcpEqDUrkPyZgfvXhmeBhQrANldeXjIz41tBe3AYJS869bdquoGf-V-ostzMrw275zTQIMvcy8prlZD5pBWaztuZpidzB8VMi4XUdt2IW3xQCy0Wphoys91EYdoVURsuMRQNZ_lDMMOuHLFADd95qA1m6545Fnzdl5nXLsa5EZa_THpPEC2MKUDSetVJws8RRK9aclI_ZRYhj7A-wOniQmUzp6HW5aGyLk-nHQQyZWRIg-sW9wMAYFewhEOFVUmEcX74OJO-HKYMoa92xoRoBXv6p88WvHjJsqez-K2Jg2phofor8TOpw-s8YHnJeI78XebsUT_qGH4pjHsdCt1JBrlerj1Z9AgxEByf74JRX4R1b5DeduUbZ5Kc6GTtF6nqPp4k6BjgXM3q37TfnFatZL9ptNOEc';

  if (token) {
    config.headers.Authorization = `Bearer ${token.replace(/^"|"$/g, '')}`;
  }
  return config;
});

client.interceptors.response.use(
  (response) => response,
  (error) => {
    throw new Error(error.response?.data?.error ?? 'Something went wrong');
  }
);
